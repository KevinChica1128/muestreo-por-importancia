integrate(h,0,1)
Espteor<-integrate(h,0,1) #0.6228062
Esp2teor<-integrate(h,0,1) #0.3904824
Esp2teor
Varteori<-0.3904824-(0.6228062)^2
Varteori
h<-function(x){((2+x)^y1)*((1-x)^(y2+y3+b-1))*x^(y4+a-1)}
w<-h(p)/dbeta(p,1,1)
E<-(1/sum(w))*(sum(w*p))
V<-(1/sum(w))*(sum(w*(p^2)))
E
V<-(1/sum(w))*(sum(w*(p^2)))
V
E
#N=20
y11=14
y22=0
y33=1
y44=5
h1<-function(x){(1/41575.13)*((2+x)^y11)*((1-x)^(y22+y33+b-1))*x^(y44+a-1)*(x^2)}
#Función de importancia Beta
p00<-rbeta(m,1,1)
w00<-h1(p00)/pbeta(p00,1,1)
E00<-(1/sum(w00))*(sum(w00*p00))
V00<-(1/sum(w00))*(sum(w00*p00^2))
E00
#Función de importancia normal
p1<-rnorm(m,0.6268,0.002649)
w1<-h(p1)/qnorm(p1,0.6268,0.002649)
E1<-(1/sum(w1))*(sum(w1*p1))
V1<-(1/sum(w1))*(sum(w1*(p1^2)))
E1
#Función de importancia normal
p11<-rnorm(m,0.9034,0.008693)
w11<-h1(p11)/pnorm(p11,0.9034,0.008693)
E11<-(1/sum(w11))*(sum(w11*p11))
E11
varianza=1/N   #Varianza teorica
V
#Muestreo por importancia Ejemplos:
#Ejemplo 1:
N=10000
X<-rnorm(N)   #Esto se hizo para tener la media y la varianza teorica
xbarra=mean(X) #Media teorica
varianza=1/N   #Varianza teorica
thetai<-rt(N,N)  #Tetas generados a partir de la función de importancia t de student
w<-dnorm(thetai,xbarra,sqrt(varianza))/dt(thetai,N) #Pesos
E<-(1/sum(w))*(sum(w*thetai))  #Esperanza estimada
V<-(1/sum(w))*(sum(w*(thetai^2))) #Varianza estimada
#Muestreo por importancia Ejemplos:
#Ejemplo 1:
N=10000
X<-rnorm(N)   #Esto se hizo para tener la media y la varianza teorica
xbarra=mean(X) #Media teorica
varianza=1/N   #Varianza teorica
theta1<-rt(N,N)  #Tetas generados a partir de la función de importancia t de student
w<-dnorm(theta1,xbarra,sqrt(varianza))/dt(theta1,N) #Pesos
E<-(1/sum(w))*(sum(w*theta1))  #Esperanza estimada
V<-(1/sum(w))*(sum(w*(theta1^2))) #Varianza estimada
E
xbarra
varianza=1/N   #Varianza teorica
varianza
V
teta2<-runif(N)
w1<-funcion(teta2)/dunif(teta2)
E1<-(1/sum(w1))*(sum(w1*teta2))  #Esperanza estimada
#Ejemplo 2:
funcion<-function(x){(gamma(14)/(gamma(10)*gamma(4)))*(x^9)*((1-x)^3)*x} #E(X)
funcion2<-function(x){(gamma(14)/(gamma(10)*gamma(4)))*(x^9)*((1-x)^3)*(x^2)} #E(X^2)
Eteorica<-integrate(funcion,0,1)
E2teorica<-integrate(funcion2,0,1)
Vteorica<-E2teorica-(Eteorica^2) #Resultado:
teta2<-runif(N)
w1<-funcion(teta2)/dunif(teta2)
E1<-(1/sum(w1))*(sum(w1*teta2))  #Esperanza estimada
V1<-(1/sum(w1))*(sum(w1*(teta2^2))) #Varianza estimada
E1
Eteorica
V1
Vteorica
#Ejemplo 2:
funcion<-function(x){(gamma(14)/(gamma(10)*gamma(4)))*(x^9)*((1-x)^3)*x} #E(X)
funcion2<-function(x){(gamma(14)/(gamma(10)*gamma(4)))*(x^9)*((1-x)^3)*(x^2)} #E(X^2)
Eteorica<-integrate(funcion,0,1)
E2teorica<-integrate(funcion2,0,1)
Vteorica<-E2teorica-(Eteorica^2) #Resultado:
Eteorica
E2teorica
#Ejemplo 2:
funcion<-function(x){(gamma(14)/(gamma(10)*gamma(4)))*(x^9)*((1-x)^3)*x} #E(X)
integrate(funcion,0,1)
#Ejemplo 2:
funcion<-function(x){(gamma(14)/(gamma(10)*gamma(4)))*(x^9)*((1-x)^3)} #E(X)
integrate(funcion,0,1)
#Ejemplo 2:
funcion<-function(x){(gamma(14)/(gamma(10)*gamma(4)))*(x^9)*((1-x)^3)*x} #E(X)
funcion2<-function(x){(gamma(14)/(gamma(10)*gamma(4)))*(x^9)*((1-x)^3)*(x^2)} #E(X^2)
Eteorica
teta2<-runif(N)
w1<-funcion(teta2)/dunif(teta2)
E1<-(1/sum(w1))*(sum(w1*teta2))  #Esperanza estimada
V1<-(1/sum(w1))*(sum(w1*(teta2^2))) #Varianza estimada
E1
V1
teta2^2
w1*(teta2^2)
sum(w1*(teta2^2)
sum(w1*(teta2^2))
sum(w1*(teta2^2))
(1/sum(w1))
V1
E1
#Muestreo por importancia Ejemplos:
#Ejemplo 1:
N=10000
X<-rnorm(N)   #Esto se hizo para tener la media y la varianza teorica
xbarra=mean(X) #Media teorica
E2teorica
V1
#Ejemplo 3 (INCOMPLETO)
#N=197
m=10000
N=197
y1=125
y2=18
y3=20
y4=34
a=b=1
#Esperanza de la exacta con la regla de Simpson:
I=
#Función de importancia Beta
p<-rbeta(m,1,1)
h<-function(x){((2+x)^y1)*((1-x)^(y2+y3+b-1))*x^(y4+a-1)}
w<-h(p)/dbeta(p,1,1)
E<-(1/sum(w))*(sum(w*p)) #0.6226815
V<-(1/sum(w))*(sum(w*(p^2))) #0.3902821
V
E<-(1/sum(w))*(sum(w*p)) #0.6226815
#Esperanza de la exacta con la regla de Simpson:
I=
#Función de importancia Beta
p<-rbeta(m,1,1)
h<-function(x){((2+x)^y1)*((1-x)^(y2+y3+b-1))*x^(y4+a-1)}
w<-h(p)/dbeta(p,1,1)
E<-(1/sum(w))*(sum(w*p)) #0.6226815
EB2<-(1/sum(w))*(sum(w*(p^2))) #0.3902821 #E(x2)
#Esperanza de la exacta con la regla de Simpson:
I=
#Función de importancia Beta
p<-rbeta(m,1,1)
#Ejemplo 3 (INCOMPLETO)
#N=197
m=10000
N=197
y1=125
y2=18
y3=20
y4=34
a=b=1
#Función de importancia Beta
p<-rbeta(m,1,1)
h<-function(x){((2+x)^y1)*((1-x)^(y2+y3+b-1))*x^(y4+a-1)}
w<-h(p)/dbeta(p,1,1)
E<-(1/sum(w))*(sum(w*p)) #0.6226815
EB2<-(1/sum(w))*(sum(w*(p^2))) #0.3902821 #E(x2)
VB<-EB2-(E^2)
VB
VN<-EN2-(E1^2)
E1<-(1/sum(w1))*(sum(w1*p1))
EN2<-(1/sum(w1))*(sum(w1*(p1^2)))
#Función de importancia normal
p1<-rnorm(m,0.6268,0.002649)
w1<-h(p1)/qnorm(p1,0.6268,0.002649)
E1<-(1/sum(w1))*(sum(w1*p1))
EN2<-(1/sum(w1))*(sum(w1*(p1^2)))
VN<-EN2-(E1^2)
VN
EB2
VB
#Función de importancia normal
p1<-rnorm(m,0.6268,0.002649)
w1<-h(p1)/qnorm(p1,0.6268,0.002649)
E1<-(1/sum(w1))*(sum(w1*p1))
EN2<-(1/sum(w1))*(sum(w1*(p1^2)))
VN<-EN2-(E1^2)
VN
E1
EN2
Varteori
#exacta
integrate(h,0,1)
Espteor<-integrate(h,0,1) #0.6228062
Esp2teor<-integrate(h,0,1) #0.3904824
Varteori<-0.3904824-(0.6228062)^2
Varteori
Esp2teor
#exacta
integrate(h,0,1)
h<-function(x){(1/2.357695e+28)*((2+x)^y1)*((1-x)^(y2+y3+b-1))*x^(y4+a-1)*(x^2)}
w<-h(p)/dbeta(p,1,1)
EB2<-(1/sum(w))*(sum(w*(p^2))) #0.3902821 #E(x2)
EB2
EN2
Espteor
h<-function(x){(1/2.357695e+28)*((2+x)^y1)*((1-x)^(y2+y3+b-1))*x^(y4+a-1)*(x)}
Espteor<-integrate(h,0,1) #0.6228062
Espteor
E1
EN2
h<-function(x){(1/2.357695e+28)*((2+x)^y1)*((1-x)^(y2+y3+b-1))*x^(y4+a-1)*(x^2)}
EB2<-(1/sum(w))*(sum(w*(p^2))) #0.3902821 #E(x2)
Esp2teor<-integrate(h,0,1) #0.3904824
Esp2teor
EN2<-(1/sum(w1))*(sum(w1*(p1^2)))
EN2
VN
Varteori
E1
EN2
VN<-EN2-(E1)^2
VN
#Función de importancia normal
p1<-rnorm(m,0.6268,0.002649)
w1<-h(p1)/dnorm(p1,0.6268,0.002649)
E1<-(1/sum(w1))*(sum(w1*p1))
EN2<-(1/sum(w1))*(sum(w1*(p1^2)))
VN<-EN2-(E1)^2
VN
E1
EN2
VN
Varteori
h<-function(x){((2+x)^y1)*((1-x)^(y2+y3+b-1))*x^(y4+a-1)}
#Función de importancia Beta
p<-rbeta(m,1,1)
w<-h(p)/dbeta(p,1,1)
E<-(1/sum(w))*(sum(w*p)) #0.6226815
EB2<-(1/sum(w))*(sum(w*(p^2))) #0.3902821 #E(x2)
VB<-EB2-(E^2)
E
EB2
VB
#Función de importancia normal
p1<-rnorm(m,0.6268,0.002649)
w1<-h(p1)/dnorm(p1,0.6268,0.002649)
E1<-(1/sum(w1))*(sum(w1*p1))
EN2<-(1/sum(w1))*(sum(w1*(p1^2)))
VN<-EN2-(E1)^2
VN
EN2
E1
#----------------------------------------------------------#
#N=20
y11=14
y22=0
y33=1
y44=5
h1<-function(x){(1/41575.13)*((2+x)^y11)*((1-x)^(y22+y33+b-1))*x^(y44+a-1)*(x^2)}
#Función de importancia Beta
p00<-rbeta(m,1,1)
w00<-h1(p00)/pbeta(p00,1,1)
E00<-(1/sum(w00))*(sum(w00*p00))
V00<-(1/sum(w00))*(sum(w00*p00^2))
E00
V00
#Función de importancia Beta
p00<-rbeta(m,1,1)
w00<-h1(p00)/pbeta(p00,1,1)
E00<-(1/sum(w00))*(sum(w00*p00))
V00<-(1/sum(w00))*(sum(w00*p00^2))
E00
View(h1)
#Ejemplo 3
#----------------------------------------#
#N=197
m=10000
N=197
y1=125
y2=18
y3=20
y4=34
a=b=1
h<-function(x){((2+x)^y1)*((1-x)^(y2+y3+b-1))*x^(y4+a-1)}
#exacta
integrate(h,0,1)
Espteor<-integrate(h,0,1) #0.6228062
Esp2teor<-integrate(h,0,1) #0.3904824
Varteori<-0.3904824-(0.6228062)^2
Esp2teor
#Función de importancia Beta
p<-rbeta(m,1,1)
w<-h(p)/dbeta(p,1,1)
E<-(1/sum(w))*(sum(w*p)) #0.6226815
EB2<-(1/sum(w))*(sum(w*(p^2))) #0.3902821 #E(x2)
VB<-EB2-(E^2)
E
EB2
VB
#Función de importancia normal
p1<-rnorm(m,0.6268,0.002649)
w1<-h(p1)/dnorm(p1,0.6268,0.002649)
E1<-(1/sum(w1))*(sum(w1*p1))
E1
EN2<-(1/sum(w1))*(sum(w1*(p1^2)))
EN2
VN<-EN2-(E1)^2
VN
E
EB2
E1
EN2
VB<-EB2-(E^2)
VB
VN<-EN2-(E1)^2
VN
VN<-EN2-(E1^2)
VN
E1^2
EN2
E1<-(1/sum(w1))*(sum(w1*p1)) #
E1
EN2
p<-rbeta(m,1,1)
w<-h(p)/dbeta(p,1,1)
E<-(1/sum(w))*(sum(w*p)) #0.6226815
EB2<-(1/sum(w))*(sum(w*(p^2))) #0.3902821 #E(x^2)
VB<-EB2-(E^2)
VB
p1<-rnorm(m,0.6268,0.002649)
w1<-h(p1)/dnorm(p1,0.6268,0.002649)
E1<-(1/sum(w1))*(sum(w1*p1)) #0.6255348
EN2<-(1/sum(w1))*(sum(w1*(p1^2))) #0.3913354 #E(x^2)
VN<-EN2-(E1^2)
VN
EB2
E^2
EN2
E1^2
#Función de importancia normal
p1<-rnorm(m,0.6268,0.002649)
w1<-h(p1)/dnorm(p1,0.6268,0.002649)
E1<-(1/sum(w1))*(sum(w1*p1)) #0.6255348
EN2<-(1/sum(w1))*(sum(w1*(p1^2))) #0.3913354 #E(x^2)
VN<-EN2-(E1^2)
VN
#----------------------------------------------------------#
#N=20
y11=14
y22=0
y33=1
y44=5
h1<-function(x){((2+x)^y11)*((1-x)^(y22+y33+b-1))*x^(y44+a-1)}
#exacta
integrate(h1,0,1)
Espteor00<-integrate(h1,0,1) #0.8311239
Esp2teor00<-integrate(h1,0,1) #0.7024182
Varteori00<-0.7024182-(0.8311239)^2
Varteori00
#Función de importancia Beta
p00<-rbeta(m,1,1)
w00<-h1(p00)/dbeta(p00,1,1)
E00<-(1/sum(w00))*(sum(w00*p00))
V00<-(1/sum(w00))*(sum(w00*p00^2))
E00<-(1/sum(w00))*(sum(w00*p00))
E00
E200<-(1/sum(w00))*(sum(w00*p00^2))
E200
V00<-E200-(E00^2)
V00
#Función de importancia normal
p11<-rnorm(m,0.9034,0.008693)
w11<-h1(p11)/dnorm(p11,0.9034,0.008693)
E11<-(1/sum(w11))*(sum(w11*p11))
E211<-(1/sum(w00))*(sum(w00*p00^2)) #0.6981653
E11
E11<-(1/sum(w11))*(sum(w11*p11))
E11
#Función de importancia normal
p11<-rnorm(m,0.9034,0.008693)
w11<-h1(p11)/dnorm(p11,0.9034,0.008693)
E11<-(1/sum(w11))*(sum(w11*p11))
E211<-(1/sum(w11))*(sum(w11*p11^2)) #0.6981653
V11<-E211-(E11^2)
E11
E211<-(1/sum(w11))*(sum(w11*p11^2)) #0.6981653
E211
V11<-E211-(E11^2)
V11
V00
#Función de importancia normal
p11<-rnorm(m,0.9034,0.008693)
w11<-h1(p11)/dnorm(p11,0.9034,0.008693)
E11<-(1/sum(w11))*(sum(w11*p11))  #0.9042977
E11
E211<-(1/sum(w11))*(sum(w11*p11^2)) #0.8181377
V11<-E211-(E11^2) #0.0003833
V11
#Ejemplo 2:
funcion<-function(x){(gamma(14)/(gamma(10)*gamma(4)))*(x^9)*((1-x)^3)*x} #E(X)
funcion2<-function(x){(gamma(14)/(gamma(10)*gamma(4)))*(x^9)*((1-x)^3)*(x^2)} #E(X^2)
Eteorica<-integrate(funcion,0,1)
E2teorica<-integrate(funcion2,0,1)
Vteorica<-E2teorica-(Eteorica^2) #Resultado:
#Ejemplo 2:
funcion<-function(x){(gamma(14)/(gamma(10)*gamma(4)))*(x^9)*((1-x)^3)*x} #E(X)
funcion2<-function(x){(gamma(14)/(gamma(10)*gamma(4)))*(x^9)*((1-x)^3)*(x^2)} #E(X^2)
Eteorica<-integrate(funcion,0,1)
E2teorica<-integrate(funcion2,0,1)
Vteorica<-E2teorica-(Eteorica^2) #Resultado:
Eteorica
E2teorica
Vteorica<-0.5238095-(0.7142857^2) #Resultado:
Vteorica
teta2<-runif(N)
w1<-funcion(teta2)/dunif(teta2)
E1<-(1/sum(w1))*(sum(w1*teta2))  #Esperanza estimada
V1<-(1/sum(w1))*(sum(w1*(teta2^2))) #Varianza estimada
#Muestreo por importancia Ejemplos:
#Ejemplo 1:
N=10000
teta2<-runif(N)
w1<-funcion(teta2)/dunif(teta2)
E1<-(1/sum(w1))*(sum(w1*teta2))  #Esperanza estimada
V1<-(1/sum(w1))*(sum(w1*(teta2^2))) #Varianza estimada
E1<-(1/sum(w1))*(sum(w1*teta2))  #Esperanza estimada
E21<-(1/sum(w1))*(sum(w1*(teta2^2))) #Varianza estimada
E1
E21
V1<-E21-(E1^2)
V1
E1
E21
Eteorica
Vteorica
Betaest
#Estimación por PCR(escala original)
Betaori<-c()
cadata <- read.csv("~/GitHub/tarea_aplicada_4/cadata.txt", sep="")
## El número aleatorio generado fue 15529 ##
# Eliminamos las filas que no necesitamos, nos quedamos con las filas desde la 15529 hasta la 16029 #
cadata<- cadata[-c(1:15528,16029:20640),]
#Ajuste del modelo completo:
Regresion<- lm(cadata$Valor_mediano_de_la_casa ~ cadata$Ingreso_mediano+cadata$Edad_mediana_de_la_vivienda+cadata$Total_de_habitaciones+cadata$Total_de_dormitorios+cadata$Poblacion+cadata$Hogares)
summary(Regresion)
x1<-cadata$Ingreso_mediano
x2<-cadata$Edad_mediana_de_la_vivienda
x3<-cadata$Total_de_habitaciones
x4<-cadata$Total_de_dormitorios
x5<-cadata$Poblacion
x6<-cadata$Hogares
X1<-(x1-mean(x1))/sqrt(sum(x1^2)-(length(x1)*mean(x1)^2))
X2<-(x2-mean(x2))/sqrt(sum(x2^2)-(length(x2)*mean(x2)^2))
X3<-(x3-mean(x3))/sqrt(sum(x3^2)-(length(x3)*mean(x3)^2))
X4<-(x4-mean(x4))/sqrt(sum(x4^2)-(length(x4)*mean(x4)^2))
X5<-(x5-mean(x5))/sqrt(sum(x5^2)-(length(x5)*mean(x5)^2))
X6<-(x6-mean(x6))/sqrt(sum(x6^2)-(length(x6)*mean(x6)^2))
Xr<-cbind(X1,X2,X3,X4,X5,X6)
#Estimación por PCR (Estandarizados):
y<-cadata$Valor_mediano_de_la_casa
Y<-(y-mean(y))/sqrt(sum(y^2)-(length(y)*mean(y)^2))
y<-cadata$Valor_mediano_de_la_casa
eigen(Rr)
T<-eigen(Rr)$vectors
Z<-Xr%*%T
A<-t(Z)%*%Z
alfae<-solve(A)%*%t(Z)%*%Y
alfaec<-c(1,1,1,0,0,0)*alfae
Betaest<-T%*%alfae
mean(Y)
#X*t X en forma de correlacion es:
Rr<-t(Xr)%*%Xr
y<-cadata$Valor_mediano_de_la_casa
eigen(Rr)
T<-eigen(Rr)$vectors
Z<-Xr%*%T
A<-t(Z)%*%Z
alfae<-solve(A)%*%t(Z)%*%Y
alfaec<-c(1,1,1,0,0,0)*alfae
Betaest<-T%*%alfae
mean(Y)
Betaori<-c()
Betaori[1]=Betaest[1]*(sd(y)/sd(x1))
Betaori[2]=Betaest[2]*(sd(y)/sd(x2))
Betaori[3]=Betaest[3]*(sd(y)/sd(x3))
Betaori[4]=Betaest[4]*(sd(y)/sd(x4))
Betaori[5]=Betaest[5]*(sd(y)/sd(x5))
Betaori[6]=Betaest[6]*(sd(y)/sd(x6))
Betaori
summary(Regresion)
#Estimación por PCR(escala original)
Betaori<-c()
Betaori[1]=Betaest[1]*(sd(y)/sd(x1))
Betaori[2]=Betaest[2]*(sd(y)/sd(x2))
Betaori[3]=Betaest[3]*(sd(y)/sd(x3))
Betaori[4]=Betaest[4]*(sd(y)/sd(x4))
Betaori[5]=Betaest[5]*(sd(y)/sd(x5))
Betaori[6]=Betaest[6]*(sd(y)/sd(x6))
Betaori
summary(Regresion)
alfaec<-c(1,1,1,0,0,0)*alfae
Betaest<-T%*%alfaec
#Estimación por PCR(escala original)
Betaori<-c()
Betaori[1]=Betaest[1]*(sd(y)/sd(x1))
Betaori[2]=Betaest[2]*(sd(y)/sd(x2))
Betaori[3]=Betaest[3]*(sd(y)/sd(x3))
Betaori[4]=Betaest[4]*(sd(y)/sd(x4))
Betaori[5]=Betaest[5]*(sd(y)/sd(x5))
Betaori[6]=Betaest[6]*(sd(y)/sd(x6))
Betaori
YajustPCR<-mean(y)+Betaori[1]x1+Betaori[2]x2+Betaori[3]x3+Betaori[4]x4+Betaori[5]x5+Betaori[6]x6
