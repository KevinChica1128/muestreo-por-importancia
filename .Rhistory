Y<-(y-mean(y))/sqrt(sum(y^2)-(length(y)*mean(y)^2))
y<-cadata$Valor_mediano_de_la_casa
eigen(Rr)
T<-eigen(Rr)$vectors
Z<-Xr%*%T
A<-t(Z)%*%Z
alfae<-solve(A)%*%t(Z)%*%Y
alfaec<-c(1,1,1,0,0,0)*alfae
Betaest<-T%*%alfae
mean(Y)
#X*t X en forma de correlacion es:
Rr<-t(Xr)%*%Xr
y<-cadata$Valor_mediano_de_la_casa
eigen(Rr)
T<-eigen(Rr)$vectors
Z<-Xr%*%T
A<-t(Z)%*%Z
alfae<-solve(A)%*%t(Z)%*%Y
alfaec<-c(1,1,1,0,0,0)*alfae
Betaest<-T%*%alfae
mean(Y)
Betaori<-c()
Betaori[1]=Betaest[1]*(sd(y)/sd(x1))
Betaori[2]=Betaest[2]*(sd(y)/sd(x2))
Betaori[3]=Betaest[3]*(sd(y)/sd(x3))
Betaori[4]=Betaest[4]*(sd(y)/sd(x4))
Betaori[5]=Betaest[5]*(sd(y)/sd(x5))
Betaori[6]=Betaest[6]*(sd(y)/sd(x6))
Betaori
summary(Regresion)
#Estimación por PCR(escala original)
Betaori<-c()
Betaori[1]=Betaest[1]*(sd(y)/sd(x1))
Betaori[2]=Betaest[2]*(sd(y)/sd(x2))
Betaori[3]=Betaest[3]*(sd(y)/sd(x3))
Betaori[4]=Betaest[4]*(sd(y)/sd(x4))
Betaori[5]=Betaest[5]*(sd(y)/sd(x5))
Betaori[6]=Betaest[6]*(sd(y)/sd(x6))
Betaori
summary(Regresion)
alfaec<-c(1,1,1,0,0,0)*alfae
Betaest<-T%*%alfaec
#Estimación por PCR(escala original)
Betaori<-c()
Betaori[1]=Betaest[1]*(sd(y)/sd(x1))
Betaori[2]=Betaest[2]*(sd(y)/sd(x2))
Betaori[3]=Betaest[3]*(sd(y)/sd(x3))
Betaori[4]=Betaest[4]*(sd(y)/sd(x4))
Betaori[5]=Betaest[5]*(sd(y)/sd(x5))
Betaori[6]=Betaest[6]*(sd(y)/sd(x6))
Betaori
YajustPCR<-mean(y)+Betaori[1]x1+Betaori[2]x2+Betaori[3]x3+Betaori[4]x4+Betaori[5]x5+Betaori[6]x6
betas<-rbeta(10000,54.723205,32.58249)
betas
x11()
plot(density(betas))
#Función de importancia Beta
p<-rbeta(m,54.723205,32.58249)
#Ejemplo 3
#----------------------------------------#
#N=197
m=10000
N=197
y1=125
y2=18
y3=20
y4=34
a=b=1
h<-function(x){((2+x)^y1)*((1-x)^(y2+y3+b-1))*x^(y4+a-1)}
#exacta
integrate(h,0,1)
Espteor<-integrate(h,0,1) #0.6228062
Esp2teor<-integrate(h,0,1) #0.3904824
Varteori<-0.3904824-(0.6228062)^2
Varteori
#Función de importancia Beta
p<-rbeta(m,54.723205,32.58249)
w<-h(p)/dbeta(p,1,1)
E<-(1/sum(w))*(sum(w*p)) #0.6226815
EB2<-(1/sum(w))*(sum(w*(p^2))) #0.3902821 #E(x^2)
VB<-EB2-(E^2)
E
EB2
VB
#Función de importancia Beta
p<-rbeta(m,54.723205,32.58249)
w<-h(p)/dbeta(p,54.723205,32.58249)
E<-(1/sum(w))*(sum(w*p)) #0.6226815
EB2<-(1/sum(w))*(sum(w*(p^2))) #0.3902821 #E(x^2)
VB<-EB2-(E^2)
E
EB2
VB
#Función de importancia normal
p1<-rnorm(m,0.6268,0.002649)
w1<-h(p1)/dnorm(p1,0.6268,0.002649)
E1<-(1/sum(w1))*(sum(w1*p1)) #0.6255348
EN2<-(1/sum(w1))*(sum(w1*(p1^2))) #0.3913354 #E(x^2)
VN<-EN2-(E1^2) #0.000032416
VN
E1
VN
E1<-(1/sum(w1))*(sum(w1*p1)) #0.6255348
EN2<-(1/sum(w1))*(sum(w1*(p1^2))) #0.3913354 #E(x^2)
VN<-EN2-(E1^2) #0.000032416
#Función de importancia normal
p1<-rnorm(m,0.6268,0.002649)
w1<-h(p1)/dnorm(p1,0.6268,0.002649)
E1<-(1/sum(w1))*(sum(w1*p1)) #0.6255348
EN2<-(1/sum(w1))*(sum(w1*(p1^2))) #0.3913354 #E(x^2)
VN<-EN2-(E1^2) #0.000032416
E1
EN2
VN
x11()
plot(density(p),col="red",lty=2,lwd=2)
lines(density(p1),lwd=2)
x11()
plot(p,h(p))
x11()
plot(p1,h(p1))
p3<-runif(m)
x11()
plot(p3,h(p3))
x11()
plot(p3,h(p3),xlim=c(0.4,0.8))
x11()
plot(p,h(p))
lines(density(p1),lwd=2)
x11()
plot(density(p))
lines(density(p1),lwd=2)
#Función de importancia normal
p1<-rnorm(m,0.6268,sqrt(0.002649))
w1<-h(p1)/dnorm(p1,0.6268,0.002649)
E1<-(1/sum(w1))*(sum(w1*p1)) #0.6255348
EN2<-(1/sum(w1))*(sum(w1*(p1^2))) #0.3913354 #E(x^2)
VN<-EN2-(E1^2) #0.000032416
x11()
plot(density(p))
lines(density(p1),lwd=2)
x11()
plot(p,h(p))
x11()
plot(p1,h(p1))
x11()
plot(p,h(p))
x11()
plot(p1,h(p1))
#exacta
integrate(h,0,1)
h<-function(x){(1/2.357695e+28)*((2+x)^y1)*((1-x)^(y2+y3+b-1))*x^(y4+a-1)}
x11()
plot(p3,h(p3))
x11()
plot(p3,h(p3),xlim=c(0.4,0.8))
x11()
plot(p3,h(p3),xlim=c(0.5,0.8))
x11()
plot(p3,h(p3),xlim=c(0.45,0.8))
h<-function(x){((2+x)^y1)*((1-x)^(y2+y3+b-1))*x^(y4+a-1)}
hexacta<-function(x){(1/2.357695e+28)*((2+x)^y1)*((1-x)^(y2+y3+b-1))*x^(y4+a-1)}
x11()
plot(p3,hexacta(p3),xlim=c(0.45,0.8))
lines(p,h(p))
lines(p1,h(p1))
x11()
plot(p3,hexacta(p3),xlim=c(0.45,0.8))
lines(p,h(p),col="Red")
lines(p1,h(p1),col="green")
x11()
plot(p3,hexacta(p3),xlim=c(0.45,0.8),freq=F)
lines(p,h(p),col="Red")
lines(p1,h(p1),col="green")
x11()
plot(p3,hexacta(p3),xlim=c(0.45,0.8),freq=F)
lines(p,h(p),col="Red",type = "l")
lines(p1,h(p1),col="green")
x11()
curve(hexacta,0,1)
x11()
curve(hexacta,0,1,10000)
x11()
plot(p,h(p))
curve(hexacta,0,1,10000,add = TRUE)
x11()
curve(hexacta,0,1,10000,add = TRUE)
x11()
curve(hexacta,0,1,10000)
x11()
curve(hexacta,0,1,10000)
curve(h(p),add=TRUE)
x11()
plot(h(p))
curve(hexacta,0,1,10000,add=TRUE)
x11()
plot(p,h(p))
curve(hexacta,0,1,10000,add=TRUE)
x11()
plot(density(p))
curve(hexacta,0,1,10000,add=TRUE)
x11()
plot(density(p))
plot(density(p1))
curve(hexacta,0,1,10000,add=TRUE)
x11()
plot(density(p))
plot(density(p1),add=TRUE)
curve(hexacta,0,1,10000,add=TRUE)
x11()
plot(density(p),col="green")
plot(density(p1),add=TRUE)
curve(hexacta,0,1,10000,add=TRUE)
x11()
plot(density(p),col="green")
plot(density(p1),add=TRUE,col="red")
curve(hexacta,0,1,10000,add=TRUE)
x11()
plot(density(p),col="green",type = "l")
plot(density(p1),add=TRUE,col="red")
curve(hexacta,0,1,10000,add=TRUE)
x11()
plot(density(p),col="green")
curve(hexacta,0,1,10000,add=TRUE)
plot(density(p1),add=TRUE,col="red")
x11()
plot(density(p),col="green")
curve(density(p1),add=TRUE,col="red")
curve(hexacta,0,1,10000,add=TRUE)
x11()
plot(density(p),col="green")
curve(p1,add=TRUE,col="red")
curve(hexacta,0,1,10000,add=TRUE)
x11()
plot(density(p),col="green")
points(pi,h(p1),add=TRUE,col="red")
curve(hexacta,0,1,10000,add=TRUE)
x11()
plot(density(p),col="green")
points(p1,h(p1),add=TRUE,col="red")
curve(hexacta,0,1,10000,add=TRUE)
x11()
plot(density(p),col="green")
points(p1,h(p1),col="red")
curve(hexacta,0,1,10000,add=TRUE)
points(p1,h(p1),col="red")
x11()
plot(density(p),col="green")
points(p1,h(p1),col="red")
curve(hexacta,0,1,10000,add=TRUE)
points(p1,h(p1),col="red")
x11()
plot(density(p),col="green")
points(p1,h(p1),col="red")
points(p1,h(p1),col="red")
x11()
points(p1,h(p1),col="red")
x11()
plot(density(p),col="green")
lines(p1,h(p1),col="red")
curve(hexacta,0,1,10000,add=TRUE)
x11()
plot(density(p),col="green")
curve(hexacta,0,1,10000,add=TRUE)
x11()
plot(p3,hexacta(p3),xlim=c(0.45,0.8),freq=F)
lines(p,h(p),col="Red")
lines(p1,h(p1),col="green")
x11()
plot(density(p))
lines(density(p1),lwd=2)
x11()
plot(density(p),col="green")
curve(hexacta,0,1,10000,add=TRUE)
lines(density(p1),lwd=2)
x11()
plot(density(p),col="green",ylab = "h(theta1|y)")
install.packages("plotmath")
x11()
plot(density(p),col="green",ylab = expression(h(theta1|y))
x11()
plot(density(p),col="green",main=expresión ( pegar ( "Sampled values" ,  mu ,  "= 5," ,  sigma ,
"= 1") ) )
x11()
plot(density(p),col="green",main=expression ( pegar ( "Sampled values" ,  mu ,  "= 5," ,  sigma ,
"= 1") ) )
x11()
plot(density(p),col="green",main=expression ( paste ( "Sampled values" ,  mu ,  "= 5," ,  sigma ,
"= 1") ) )
curve(hexacta,0,1,10000,add=TRUE)
lines(density(p1),lwd=2)
x11()
plot(density(p),col="green",ylab=expression ( paste ( "Sampled values" ,  mu ,  "= 5," ,  sigma ,
"= 1") ) )
x11()
plot(density(p),col="green",ylab=expression(h(theta1|y)))
x11()
plot(density(p),col="green",ylab=expression(paste("h(",theta,"|y)")))
x11()
plot(density(p),col="green",ylab=expression(paste("h(",theta,"|y)")),xlab = expression(theta))
curve(hexacta,0,1,10000,add=TRUE)
lines(density(p1),lwd=2)
x11()
plot(density(p),col="green",ylab=expression(paste("h(",theta,"|y)"))
,xlab = expression(theta),main = "Aproximación distribuciones a posteriori")
x11()
plot(density(p),col="green",ylab=expression(paste("h(",theta,"|y)"))
,xlab = expression(theta),main = "Aproximación distribuciones a posteriori")
curve(hexacta,0,1,10000,add=TRUE)
lines(density(p1),lwd=2)
x11()
plot(density(p),col="green",ylab=expression(paste("h(",theta,"|y)"))
,xlab = expression(theta),
main = "Aproximación distribuciones a posteriori",)
curve(hexacta,0,1,10000,add=TRUE)
lines(density(p1),lwd=2)
legend("topright",legend=c("Chlorella","Chlamydomonas"),
col=c("blue","red"),pch=c(1,2))
x11()
plot(density(p),col="green",ylab=expression(paste("h(",theta,"|y)"))
,xlab = expression(theta),
main = "Aproximación distribuciones a posteriori",lty=2)
curve(hexacta,0,1,10000,add=TRUE)
lines(density(p1),lwd=2)
legend("topright",legend=c("Exacta","Normal","Beta"),
col=c("blue","red"),pch=c(1,2))
x11()
plot(density(p),col="green",ylab=expression(paste("h(",theta,"|y)"))
,xlab = expression(theta),
main = "Aproximación distribuciones a posteriori",lty=2,lwd=2)
curve(hexacta,0,1,10000,add=TRUE)
lines(density(p1),lwd=2)
legend("topright",legend=c("Exacta","Normal","Beta"),
col=c("blue","red"),pch=c(1,2))
x11()
plot(density(p),col="green",ylab=expression(paste("h(",theta,"|y)"))
,xlab = expression(theta),
main = "Aproximación distribuciones a posteriori",lty=2,lwd=2)
curve(hexacta,0,1,10000,add=TRUE,lwd=2)
lines(density(p1),lty=3,lwd=2)
legend("topright",legend=c("Exacta","Normal","Beta"),
col=c("blue","red"),pch=c(1,2))
x11()
plot(density(p),col="green",ylab=expression(paste("h(",theta,"|y)"))
,xlab = expression(theta),
main = "Aproximación distribuciones a posteriori",lty=2,lwd=2)
curve(hexacta,0,1,10000,add=TRUE,lwd=2)
lines(density(p1),lty=3,lwd=2)
legend("topright",legend=c("Exacta","Normal","Beta"),
col=c("blue","red"),lty=c(1,2,3))
x11()
plot(density(p),col="green",ylab=expression(paste("h(",theta,"|y)"))
,xlab = expression(theta),
main = "Aproximación distribuciones a posteriori",lty=2,lwd=2)
curve(hexacta,0,1,10000,add=TRUE,lwd=2)
lines(density(p1),lty=3,lwd=2)
legend("topright",legend=c("Exacta","Normal","Beta"),
col=c("Black","Red","Green"),lty=c(1,2,3))
x11()
plot(density(p),col="green",ylab=expression(paste("h(",theta,"|y)"))
,xlab = expression(theta),
main = "Aproximación distribuciones a posteriori",lty=2,lwd=2)
curve(hexacta,0,1,10000,add=TRUE,lwd=2)
lines(density(p1),lty=3,lwd=2,col="Red")
legend("topright",legend=c("Exacta","Normal","Beta"),
col=c("Black","Red","Green"),lty=c(1,2,3))
x11()
plot(density(p),col="chartreuse4",ylab=expression(paste("h(",theta,"|y)"))
,xlab = expression(theta),
main = "Aproximación distribuciones a posteriori",lty=2,lwd=2)
curve(hexacta,0,1,10000,add=TRUE,lwd=2)
lines(density(p1),lty=3,lwd=2,col="Red")
legend("topright",legend=c("Exacta","Normal","Beta"),
col=c("Black","Red","chartreuse4"),lty=c(1,2,3))
x11()
plot(density(p),col="chartreuse4",ylab=expression(paste("h(",theta,"|y)"))
,xlab = expression(theta),
main = "Aproximación distribuciones a posteriori",lty=2,lwd=3)
curve(hexacta,0,1,10000,add=TRUE,lwd=3)
lines(density(p1),lty=3,lwd=3,col="Red")
legend("topright",legend=c("Exacta","Normal","Beta"),
col=c("Black","Red","chartreuse4"),lty=c(1,2,3))
x11()
plot(density(p),col="chartreuse4",ylab=expression(paste("h(",theta,"|y)"))
,xlab = expression(theta),
main = "Aproximación distribuciones a posteriori",lty=2,lwd=1)
curve(hexacta,0,1,10000,add=TRUE,lwd=3)
lines(density(p1),lty=3,lwd=1,col="Red")
legend("topright",legend=c("Exacta","Normal","Beta"),
col=c("Black","Red","chartreuse4"),lty=c(1,2,3))
x11()
plot(density(p),col="chartreuse4",ylab=expression(paste("h(",theta,"|y)"))
,xlab = expression(theta),
main = "Aproximación distribuciones a posteriori",lty=2,lwd=2)
curve(hexacta,0,1,10000,add=TRUE,lwd=3)
lines(density(p1),lty=3,lwd=2,col="Red")
legend("topright",legend=c("Exacta","Normal","Beta"),
col=c("Black","Red","chartreuse4"),lty=c(1,2,3))
x11()
plot(density(p),col="chartreuse4",ylab=expression(paste("h(",theta,"|y)"))
,xlab = expression(theta),
main = "Aproximación distribuciones a posteriori",lty=2,lwd=2)
curve(hexacta,0,1,10000,add=TRUE,lwd=3)
lines(density(p1),lty=3,lwd=2,col="Red")
legend("topright",legend=c("Exacta","Normal","Beta"),
col=c("Black","Red","chartreuse4"),lty=c(1,2,3))
x11()
plot(density(p),col="chartreuse4",ylab=expression(paste("h(",theta,"|y)"))
,xlab = expression(theta),
main = "Aproximación distribuciones a posteriori",lty=5,lwd=2)
curve(hexacta,0,1,10000,add=TRUE,lwd=3)
lines(density(p1),lty=3,lwd=2,col="Red")
legend("topright",legend=c("Exacta","Normal","Beta"),
col=c("Black","Red","chartreuse4"),lty=c(1,2,3))
x11()
plot(density(p),col="chartreuse4",ylab=expression(paste("h(",theta,"|y)"))
,xlab = expression(theta),
main = "Aproximación distribuciones a posteriori",lty=5,lwd=2)
curve(hexacta,0,1,10000,add=TRUE,lwd=3)
lines(density(p1),lty=2,lwd=2,col="Red")
legend("topright",legend=c("Exacta","Normal","Beta"),
col=c("Black","Red","chartreuse4"),lty=c(1,2,5))
w1<-h(p1)/dnorm(p1,0.6268,sqrt(0.002649))
E1<-(1/sum(w1))*(sum(w1*p1)) #0.6255348
EN2<-(1/sum(w1))*(sum(w1*(p1^2))) #0.3913354 #E(x^2)
VN<-EN2-(E1^2) #0.000032416
E1
VN<-EN2-(E1^2) #0.000032416
VN
EN2
w<-h(p)/dbeta(p,54.723205,32.58249)
E<-(1/sum(w))*(sum(w*p)) #0.6226815
EB2<-(1/sum(w))*(sum(w*(p^2))) #0.3902821 #E(x^2)
VB<-EB2-(E^2)
E
EB2
VB<-EB2-(E^2)
VB
hexacta<-function(x){(1/2.357695e+28)*((2+x)^y1)*((1-x)^(y2+y3+b-1))*x^(y4+a-1)*x}
Espteor<-integrate(hexacta,0,1) #0.6228062
Espteor
hexacta<-function(x){(1/2.357695e+28)*((2+x)^y1)*((1-x)^(y2+y3+b-1))*x^(y4+a-1)*(x^2)}
Esp2teor<-integrate(hexacta,0,1) #0.3904824
Esp2teor
Varteori
Varteori<-0.3904824-(0.6228062)^2
Varteori
w<-h(p)/dbeta(p,54.723205,32.58249)
E<-(1/sum(w))*(sum(w*p)) #0.6230844
E
E1<-(1/sum(w1))*(sum(w1*p1)) #0.623249
E1
VB
VN
#----------------------------------------------------------#
#N=20
y11=14
y22=0
y33=1
y44=5
h1<-function(x){((2+x)^y11)*((1-x)^(y22+y33+b-1))*x^(y44+a-1)}
#exacta
integrate(h1,0,1)
h1exacta<-function(x){(1/41575.13)*((2+x)^y11)*((1-x)^(y22+y33+b-1))*x^(y44+a-1)}
h1exacta<-function(x){(1/41575.13)*((2+x)^y11)*((1-x)^(y22+y33+b-1))*x^(y44+a-1)*x}
Espteor00<-integrate(h1exacta,0,1) #0.8311239
Espteor00
h1exacta<-function(x){(1/41575.13)*((2+x)^y11)*((1-x)^(y22+y33+b-1))*x^(y44+a-1)*(x^2)}
Esp2teor00<-integrate(h1exacta,0,1) #0.7024182
Esp2teor00
Varteori00<-0.7024182-(0.8311239)^2
Varteori00
#Función de importancia Beta
p00<-rbeta(m,8.165764,0.873160)
w00<-h1(p00)/dbeta(p00,8.165764,0.873160)
E00<-(1/sum(w00))*(sum(w00*p00)) #0.8284109
E200<-(1/sum(w00))*(sum(w00*p00^2)) #0.6981653
V00<-E200-(E00^2)  #0.01190065
E00
E200<-(1/sum(w00))*(sum(w00*p00^2)) #0.6981653
V00<-E200-(E00^2)  #0.01190065
E200
V00
#Función de importancia normal
p11<-rnorm(m,0.9034,sqrt(0.008693))
w11<-h1(p11)/dnorm(p11,0.9034,sqrt(0.008693))
E11<-(1/sum(w11))*(sum(w11*p11))  #0.9042977
E211<-(1/sum(w11))*(sum(w11*p11^2)) #0.8181377
V11<-E211-(E11^2) #0.0003833
E11
E211<-(1/sum(w11))*(sum(w11*p11^2)) #0.8181377
V11<-E211-(E11^2) #0.0003833
E211
V11<-E211-(E11^2) #0.0003833
V11
#Función de importancia normal
p11<-rnorm(m,0.9034,sqrt(0.008693))
w11<-h1(p11)/dnorm(p11,0.9034,sqrt(0.008693))
E11<-(1/sum(w11))*(sum(w11*p11))  #1.224096
E211<-(1/sum(w11))*(sum(w11*p11^2)) #1.494372
V11<-E211-(E11^2) #0.0003833
E11
E211
V11
x11()
plot(density(p00),col="chartreuse4",ylab=expression(paste("h(",theta,"|y)"))
,xlab = expression(theta),
main = "Aproximación distribuciones a posteriori",lty=5,lwd=2)
curve(h1exacta,0,1,10000,add=TRUE,lwd=3)
lines(density(p11),lty=2,lwd=2,col="Red")
legend("topright",legend=c("Exacta","Normal","Beta"),
col=c("Black","Red","chartreuse4"),lty=c(1,2,5))
